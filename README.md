# 心理咨询模拟系统

## 项目简介

这是一个基于Dify AI平台的专业心理咨询模拟系统，为心理咨询师提供朋辈督导练习环境。系统完整模拟了"来访者-朋辈咨询师-督导"三方互动的对话流程，帮助咨询师提升专业技能和应变能力。

### 核心价值
- **专业技能训练**：通过真实场景对话提升咨询技巧
- **即时反馈机制**：督导AI提供专业评价和建议
- **对话连续性**：保持完整的对话记忆和上下文
- **学习记录管理**：完整保存对话历史和督导评价

## 🌟 主要功能

### 1. 智能对话系统
- **来访者AI**：基于Dify工作流的真实来访者模拟，能够展现不同性格和问题类型
- **朋辈咨询师**：用户扮演咨询师角色，进行专业对话
- **督导AI**：实时评价咨询师回复，提供专业建议

### 2. 督导评价系统
- **综合评分**：1-5分的专业评分体系
- **总体评价**：对回复质量的专业分析
- **具体建议**：针对性的改进建议和技巧指导
- **评价历史**：完整的评价记录追踪

### 3. 历史记录管理
- **对话历史**：按时间分组的完整对话记录
- **评价历史**：督导评价的完整保存和查看
- **搜索功能**：快速查找历史记录
- **导出功能**：支持学习记录导出

### 4. 用户体验优化
- **响应式设计**：适配各种屏幕尺寸
- **实时状态显示**：清晰的连接和对话状态
- **优雅的界面**：专业、简洁的视觉设计
- **键盘快捷键**：Enter发送，Shift+Enter换行

## 🏗️ 系统架构

### 技术栈
- **前端**：HTML5 + CSS3 + JavaScript (ES6+)
- **代理服务器**：Node.js + Express
- **API集成**：Dify AI平台工作流
- **数据存储**：浏览器本地存储

### 文件结构
```
seeker_simulation/
├── index.html                 # 主界面文件
├── styles.css                # 样式文件
├── script.js                 # 核心业务逻辑
├── proxy-server.js           # API代理服务器
├── package.json              # Node.js依赖配置
├── test-api.js              # API连接测试工具
├── start-clean.bat           # Windows启动脚本
├── start-silent.bat          # 静默启动脚本
├── 接口文档.md               # API配置文档
├── README.md                 # 项目说明文档
├── SETUP.md                  # 部署安装指南
└── requirements.txt          # 部署环境要求
```

### API配置
系统使用两个独立的Dify Agent工作流：

1. **来访者工作流**
   - API端点：`http://dify.ai-role.cn/v1/chat-messages`
   - 功能：模拟真实来访者对话行为
   - 特点：保持对话记忆和情绪连续性

2. **督导工作流**
   - API端点：`http://dify.ai-role.cn/v1/chat-messages`
   - 功能：专业督导评价和建议
   - 输出：结构化的评价报告

## 🚀 快速开始

### 系统要求
- **操作系统**：Windows 10+ / macOS 10.14+ / Linux
- **Node.js**：14.0+ （用于代理服务器）
- **浏览器**：Chrome 80+ / Firefox 75+ / Safari 13+ / Edge 80+

### 安装步骤

1. **环境准备**
   ```bash
   # 检查Node.js版本
   node --version
   # 确保版本 >= 14.0
   ```

2. **安装依赖**
   ```bash
   cd seeker_simulation
   npm install
   ```

3. **启动服务**
   ```bash
   # 方法1：使用npm命令
   npm start

   # 方法2：使用Windows脚本
   start-clean.bat

   # 方法3：静默启动
   start-silent.bat
   ```

4. **访问系统**
   - 打开浏览器
   - 访问：`http://localhost:3000/index.html`

### API测试（可选）
```bash
# 测试API连接
node test-api.js
```

## 📖 使用指南

### 基本操作流程

1. **启动对话**
   - 点击"开始新的对话"按钮
   - 系统自动连接来访者AI
   - 等待来访者发起对话

2. **进行咨询对话**
   - 在输入框中输入专业回复
   - 点击"发送"或按Enter键
   - 系统自动处理：
     * 督导AI评价你的回复
     * 来访者AI根据回复继续对话

3. **查看督导反馈**
   - 实时查看右侧督导评价面板
   - 关注综合得分和具体建议
   - 根据建议调整咨询技巧

4. **管理历史记录**
   - 点击"查看完整历史"查看详细评价
   - 点击"📋 查看对话历史"查看对话记录
   - 使用标签页切换不同类型的历史

### 高级功能

1. **会话记忆**
   - 系统自动保持对话连续性
   - AI会记住之前的对话内容
   - 点击"开始新的对话"重置会话

2. **历史记录管理**
   - 评价历史可折叠显示
   - 支持按时间分组查看
   - 完整的历史记录弹窗

3. **状态监控**
   - 实时连接状态显示
   - 详细的错误提示
   - 调试信息输出

## 🔧 配置说明

### API配置修改
编辑 `script.js` 文件中的 `API_CONFIG` 对象：

```javascript
const API_CONFIG = {
    visitor: {
        url: 'http://dify.ai-role.cn/v1',
        key: '你的来访者API密钥'
    },
    supervisor: {
        url: 'http://dify.ai-role.cn/v1',
        key: '你的督导API密钥'
    }
};
```

### 代理服务器配置
编辑 `proxy-server.js` 修改端口和代理设置：

```javascript
const PORT = 3000; // 修改端口
```

## 🎯 使用建议

### 咨询师练习建议

1. **专业态度**
   - 将每次对话视为真实咨询场景
   - 保持专业、尊重、同理心的态度
   - 注重建立良好的咨询关系

2. **关注督导反馈**
   - 仔细阅读每次督导评价
   - 根据建议调整咨询技巧
   - 记录关键的学习要点

3. **持续改进**
   - 定期回顾历史评价记录
   - 总结常见的咨询技巧问题
   - 有针对性地进行专项练习

4. **多样化练习**
   - 尝试不同类型的来访者问题
   - 练习不同的咨询技术流派
   - 提升应变和应对能力

## 🐛 故障排除

### 常见问题

1. **API连接失败**
   - 检查网络连接
   - 验证API密钥是否正确
   - 确认代理服务器运行状态

2. **页面无法加载**
   - 确认代理服务器已启动
   - 检查端口是否被占用
   - 尝试刷新浏览器

3. **督导评价不显示**
   - 检查督导API配置
   - 查看浏览器控制台错误信息
   - 验证JSON解析是否正常

4. **历史记录丢失**
   - 确认没有开启隐私浏览模式
   - 检查浏览器本地存储设置
   - 避免清理浏览器缓存

### 调试方法

1. **浏览器开发者工具**
   - 按F12打开开发者工具
   - 查看Console选项卡的错误信息
   - 检查Network选项卡的API请求

2. **代理服务器日志**
   - 查看代理服务器控制台输出
   - 检查API请求和响应状态
   - 确认端口监听正常

## 📊 系统性能

- **响应时间**：API调用通常3-8秒
- **并发支持**：支持多个用户同时使用
- **数据安全**：本地存储，不上传到第三方服务器
- **浏览器兼容**：支持主流现代浏览器

## 🤝 贡献与反馈

如遇到问题或有改进建议，请：
1. 检查本文档的故障排除部分
2. 查看浏览器控制台错误信息
3. 联系技术支持团队

---

**版本信息**：v1.0.0
**最后更新**：2025年11月
**开发团队**：心理咨询技术小组

> 💡 **提示**：定期查看系统和API文档的更新，以获取最新功能和改进。